(function(b){b.fn.rateit=function(c){if(this.length==0)return this;c=b.extend({},b.fn.rateit.defaults,c);return this.each(function(){var a=b(this);a.hasClass("rateit")||a.addClass("rateit");var f=a.data("rateit-min")||c.min,e=a.data("rateit-max")||c.max,g=a.data("rateit-step")||c.step,m=a.data("rateit-readonly")!==undefined?a.data("rateit-readonly"):c.readonly,n=a.data("rateit-resetable")!==undefined?a.data("rateit-resetable"):c.resetable,h=a.data("rateit-backingfld")||c.backingfld,i=a.css("direction")!=
"rtl";h&&a.data("rateit-value",b(h).hide().val());bgx=a[0].style.backgroundPositionX!==undefined;a.append('<div class="rateit-reset"></div><div class="rateit-range"><div class="rateit-selected" style="height:'+c.starheight+'px"></div><div class="rateit-hover" style="height:'+c.starheight+'px"></div></div>');i||b("div.rateit-reset",a).css("float","right");var j=b("div.rateit-range",a);j.width(c.starwidth*(e-f)).height(c.starheight);if(a.data("rateit-value")){e=(a.data("rateit-value")-f)*c.starwidth;
a.find("div.rateit-selected").width(e);if(!i){e=e%c.starwidth;b.fn.rateit.setBackgroundX(b("div.rateit-selected",a),e)}}var k=b("div.rateit-reset",a);if(m)k.hide();else{if(n){e=k.width();k.click(function(){a.data("rateit-value",f);b("div.rateit-hover",a).hide().width(0);b("div.rateit-selected",a).width(0).show();h&&b(h).val(f);a.trigger("reset")})}else k.hide();j.mousemove(function(d){d=d.pageX-b(this).offset().left;i||(d=j.width()-d);d=Math.ceil(d/c.starwidth*(1/g))*c.starwidth*g;var l=b("div.rateit-hover",
a);if(l.data("width")!=d){b("div.rateit-selected",a).hide();l.width(d).show();i||b.fn.rateit.setBackgroundX(l,d%c.starwidth);l.data("width",d)}});j.mouseleave(function(){b("div.rateit-hover",a).hide().width(0);b("div.rateit-selected",a).show()});j.click(function(d){d=d.pageX-b(this).offset().left;i||(d=j.width()-d);d=Math.ceil(d/c.starwidth*(1/g));a.data("rateit-value",d*g+f);h&&b(h).val(d*g+f);b("div.rateit-selected",a).width(d*c.starwidth*g);if(!i){d=d*c.starwidth*g%c.starwidth;b.fn.rateit.setBackgroundX(b("div.rateit-selected",
a),d)}b("div.rateit-hover",a).hide();b("div.rateit-selected",a).show();a.trigger("rated")})}})};b.fn.rateit.defaults={min:0,max:5,step:0.5,starwidth:16,starheight:16,readonly:false,resetable:true};b.fn.rateit.setBackgroundX=function(c,a){bgx?c.css("background-position-x",a+"px"):c.css("background-position",function(f,e){return e.replace(/^\S+/,buffer+"px")})};b("div.rateit").rateit()})(jQuery);