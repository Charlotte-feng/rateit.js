(function(b){b.fn.rateit=function(c){if(this.length==0)return this;c=b.extend({},b.fn.rateit.defaults,c);return this.each(function(){var a=b(this);a.hasClass("rateit")||a.addClass("rateit");var g=a.data("rateit-min")||c.min,f=a.data("rateit-max")||c.max,h=a.data("rateit-step")||c.step,m=a.data("rateit-readonly")!==undefined?a.data("rateit-readonly"):c.readonly,n=a.data("rateit-resetable")!==undefined?a.data("rateit-resetable"):c.resetable,i=a.data("rateit-backingfld")||c.backingfld,j=a.css("direction")!=
"rtl";if(i){var e=b(i);a.data("rateit-value",e.hide().val());if(e[0].nodeName=="INPUT")if(e[0].type=="range"||e[0].type=="text"){g=e.attr("min")||g;f=e.attr("max")||f;h=e.attr("step")||h}if(e[0].nodeName=="SELECT"&&e[0].options.length>1){g=e[0].options[0].value;f=e[0].options[e[0].length-1].value;h=e[0].options[1].value-e[0].options[0].value}}bgx=a[0].style.backgroundPositionX!==undefined;a.append('<div class="rateit-reset"></div><div class="rateit-range"><div class="rateit-selected" style="height:'+
c.starheight+'px"></div><div class="rateit-hover" style="height:'+c.starheight+'px"></div></div>');j||b("div.rateit-reset",a).css("float","right");var k=b("div.rateit-range",a);k.width(c.starwidth*(f-g)).height(c.starheight);if(a.data("rateit-value")){f=(a.data("rateit-value")-g)*c.starwidth;a.find("div.rateit-selected").width(f);if(!j){f=f%c.starwidth;b.fn.rateit.setBackgroundX(b("div.rateit-selected",a),f)}}e=b("div.rateit-reset",a);if(m)e.hide();else{if(n){f=e.width();e.click(function(){a.data("rateit-value",
g);b("div.rateit-hover",a).hide().width(0);b("div.rateit-selected",a).width(0).show();i&&b(i).val(g);a.trigger("reset")})}else e.hide();k.mousemove(function(d){d=d.pageX-b(this).offset().left;j||(d=k.width()-d);d=Math.ceil(d/c.starwidth*(1/h))*c.starwidth*h;var l=b("div.rateit-hover",a);if(l.data("width")!=d){b("div.rateit-selected",a).hide();l.width(d).show();j||b.fn.rateit.setBackgroundX(l,d%c.starwidth);l.data("width",d)}});k.mouseleave(function(){b("div.rateit-hover",a).hide().width(0).data("width",
"");b("div.rateit-selected",a).show()});k.click(function(d){d=d.pageX-b(this).offset().left;j||(d=k.width()-d);d=Math.ceil(d/c.starwidth*(1/h));a.data("rateit-value",d*h+g);i&&b(i).val(d*h+g);b("div.rateit-selected",a).width(d*c.starwidth*h);if(!j){d=d*c.starwidth*h%c.starwidth;b.fn.rateit.setBackgroundX(b("div.rateit-selected",a),d)}b("div.rateit-hover",a).hide();b("div.rateit-selected",a).show();a.trigger("rated")})}})};b.fn.rateit.defaults={min:0,max:5,step:0.5,starwidth:16,starheight:16,readonly:false,
resetable:true};b.fn.rateit.setBackgroundX=function(c,a){bgx?c.css("background-position-x",a+"px"):c.css("background-position",function(g,f){return f.replace(/^\S+/,buffer+"px")})};b("div.rateit").rateit()})(jQuery);