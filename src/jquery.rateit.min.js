(function(b){b.fn.rateit=function(g,l){var f={},m="init";if(this.length==0)return this;var j=b.type(g);if(j=="object"||g===undefined||g==null)f=b.extend({},b.fn.rateit.defaults,g);else if(j=="string"&&l===undefined)return this.data("rateit-"+g);else if(j=="string")m="setvalue";return this.each(function(){var c=b(this),a=function(d,i){return c.data("rateit-"+d,i)};c.hasClass("rateit")||c.addClass("rateit");var k=c.css("direction")!="rtl";if(m=="setvalue"){if(!a("init"))throw"Can't set a value when plugin is not intialized";
g=="readonly"&&!a("readonly")&&b("div.rateit-range",c).unbind("mouseleave").unbind("mousemove").unbind("click");a(g,l)}if(!a("init")){a("min",a("min")||f.min);a("max",a("max")||f.max);a("step",a("step")||f.step);a("readonly",a("readonly")!==undefined?a("readonly"):f.readonly);a("resetable",a("resetable")!==undefined?a("resetable"):f.resetable);a("backingfld",a("backingfld")||f.backingfld);a("starwidth",a("starwidth")||f.starwidth);a("starheight",a("starheight")||f.starheight);a("value",a("value")||
f.min);if(a("backingfld")){var e=b(a("backingfld"));a("value",e.hide().val());if(e[0].nodeName=="INPUT")if(e[0].type=="range"||e[0].type=="text"){a("min",parseInt(e.attr("min"))||a("min"));a("max",parseInt(e.attr("max"))||a("max"));a("step",parseInt(e.attr("step"))||a("step"))}if(e[0].nodeName=="SELECT"&&e[0].options.length>1){a("min",parseInt(e[0].options[0].value));a("max",parseInt(e[0].options[e[0].length-1].value));a("step",parseInt(e[0].options[1].value-e[0].options[0].value))}}c.append('<div class="rateit-reset"></div><div class="rateit-range"><div class="rateit-selected" style="height:'+
a("starheight")+'px"></div><div class="rateit-hover" style="height:'+a("starheight")+'px"></div></div>');if(!k){b("div.rateit-reset",c).css("float","right");b("div.rateit-selected",c).addClass("rateit-selected-rtl");b("div.rateit-hover",c).addClass("rateit-hover-rtl")}a("init",true)}var h=b("div.rateit-range",c);h.width(a("starwidth")*(a("max")-a("min"))).height(a("starheight"));if(a("value")){e=(a("value")-a("min"))*a("starwidth");c.find("div.rateit-selected").width(e)}e=b("div.rateit-reset",c);
if(a("readonly"))e.hide();else{a("resetable")?e.click(function(){a("value",a("min"));b("div.rateit-hover",c).hide().width(0);b("div.rateit-selected",c).width(0).show();a("backingfld")&&b(a("backingfld")).val(a("min"));c.trigger("reset")}):e.hide();h.mousemove(function(d){d=d.pageX-b(this).offset().left;k||(d=h.width()-d);d=Math.ceil(d/a("starwidth")*(1/a("step")))*a("starwidth")*a("step");var i=b("div.rateit-hover",c);if(i.data("width")!=d){b("div.rateit-selected",c).hide();i.width(d).show();i.data("width",
d)}});h.mouseleave(function(){b("div.rateit-hover",c).hide().width(0).data("width","");b("div.rateit-selected",c).show()});h.click(function(d){d=d.pageX-b(this).offset().left;k||(d=h.width()-d);d=Math.ceil(d/a("starwidth")*(1/a("step")));a("value",d*a("step")+a("min"));a("backingfld")&&b(a("backingfld")).val(d*a("step")+a("min"));b("div.rateit-selected",c).width(d*a("starwidth")*a("step"));b("div.rateit-hover",c).hide();b("div.rateit-selected",c).show();c.trigger("rated")})}})};b.fn.rateit.defaults=
{min:0,max:5,step:0.5,starwidth:16,starheight:16,readonly:false,resetable:true};b("div.rateit").rateit()})(jQuery);